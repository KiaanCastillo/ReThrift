var imgBtn = document.createElement("img");
let src = "assets/icon.png";
var iconBase64 = "data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0iNDY1IiBoZWlnaHQ9IjQ2NCIgdmlld0JveD0iMCAwIDQ2NSA0NjQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfMTJfMjA0KSI+CjxyZWN0IHg9Ijc4IiB5PSIzOSIgd2lkdGg9IjMwOSIgaGVpZ2h0PSIzMDkiIHJ4PSI1Ny45NCIgZmlsbD0idXJsKCNwYWludDBfcmFkaWFsXzEyXzIwNCkiLz4KPGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjFfZGlfMTJfMjA0KSI+CjxwYXRoIGQ9Ik0zMDEuOTk4IDE0OC44MDRMMjc4LjA4NyAxMjQuODkyQzI3My4zMzggMTIwLjEzNyAyNjYuODk1IDExNy40NjMgMjYwLjE3NSAxMTcuNDU3SDIwNi42MDdDMTk5Ljg4NiAxMTcuNDYzIDE5My40NDMgMTIwLjEzNyAxODguNjk0IDEyNC44OTJMMTY0Ljc4MyAxNDguODA0QzE2MC4wMjggMTUzLjU1MyAxNTcuMzU0IDE1OS45OTYgMTU3LjM0OCAxNjYuNzE2VjI0NC4xOTVDMTU3LjM0OCAyNTAuOTE4IDE2MC4wMTggMjU3LjM2NSAxNjQuNzcyIDI2Mi4xMTlDMTY5LjUyNSAyNjYuODcyIDE3NS45NzMgMjY5LjU0MyAxODIuNjk1IDI2OS41NDNIMjg0LjA4NkMyOTAuODA5IDI2OS41NDMgMjk3LjI1NiAyNjYuODcyIDMwMi4wMDkgMjYyLjExOUMzMDYuNzYzIDI1Ny4zNjUgMzA5LjQzNCAyNTAuOTE4IDMwOS40MzQgMjQ0LjE5NVYxNjYuNzE2QzMwOS40MjggMTU5Ljk5NiAzMDYuNzUzIDE1My41NTMgMzAxLjk5OCAxNDguODA0Wk0yMzMuMzkxIDIyNy4yOTdDMjI0LjQyNyAyMjcuMjk3IDIxNS44MzEgMjIzLjczNiAyMDkuNDkzIDIxNy4zOThDMjAzLjE1NCAyMTEuMDYgMTk5LjU5NCAyMDIuNDYzIDE5OS41OTQgMTkzLjVDMTk5LjU5NCAxOTEuMjU5IDIwMC40ODQgMTg5LjExIDIwMi4wNjggMTg3LjUyNkMyMDMuNjUzIDE4NS45NDEgMjA1LjgwMiAxODUuMDUxIDIwOC4wNDMgMTg1LjA1MUMyMTAuMjg0IDE4NS4wNTEgMjEyLjQzMyAxODUuOTQxIDIxNC4wMTcgMTg3LjUyNkMyMTUuNjAyIDE4OS4xMSAyMTYuNDkyIDE5MS4yNTkgMjE2LjQ5MiAxOTMuNUMyMTYuNDkyIDE5Ny45ODIgMjE4LjI3MyAyMDIuMjggMjIxLjQ0MiAyMDUuNDQ5QzIyNC42MTEgMjA4LjYxOCAyMjguOTA5IDIxMC4zOTggMjMzLjM5MSAyMTAuMzk4QzIzNy44NzIgMjEwLjM5OCAyNDIuMTcxIDIwOC42MTggMjQ1LjM0IDIwNS40NDlDMjQ4LjUwOSAyMDIuMjggMjUwLjI4OSAxOTcuOTgyIDI1MC4yODkgMTkzLjVDMjUwLjI4OSAxOTEuMjU5IDI1MS4xNzkgMTg5LjExIDI1Mi43NjQgMTg3LjUyNkMyNTQuMzQ4IDE4NS45NDEgMjU2LjQ5NyAxODUuMDUxIDI1OC43MzggMTg1LjA1MUMyNjAuOTc5IDE4NS4wNTEgMjYzLjEyOCAxODUuOTQxIDI2NC43MTMgMTg3LjUyNkMyNjYuMjk3IDE4OS4xMSAyNjcuMTg4IDE5MS4yNTkgMjY3LjE4OCAxOTMuNUMyNjcuMTg4IDIwMi40NjMgMjYzLjYyNyAyMTEuMDYgMjU3LjI4OSAyMTcuMzk4QzI1MC45NSAyMjMuNzM2IDI0Mi4zNTQgMjI3LjI5NyAyMzMuMzkxIDIyNy4yOTdaTTE4Ni4xNTkgMTUxLjI1NEwyMDAuNjA4IDEzNi44MDZDMjAyLjIyNyAxMzUuMjYyIDIwNC4zNyAxMzQuMzg3IDIwNi42MDcgMTM0LjM1NUgyNjAuMTc1QzI2Mi40MTIgMTM0LjM4NyAyNjQuNTU0IDEzNS4yNjIgMjY2LjE3NCAxMzYuODA2TDI4MC42MjIgMTUxLjI1NEgxODYuMTU5WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2RfMTJfMjA0IiB4PSIwLjc1IiB5PSIwLjM3NSIgd2lkdGg9IjQ2My41IiBoZWlnaHQ9IjQ2My41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjM4LjYyNSIvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzOC42MjUiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAuMTUyOTQxIDAgMCAwIDAgMC4xNTI5NDEgMCAwIDAgMCAwLjE1Mjk0MSAwIDAgMCAwLjE2IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfMTJfMjA0Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93XzEyXzIwNCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPGZpbHRlciBpZD0iZmlsdGVyMV9kaV8xMl8yMDQiIHg9IjEzOC4wMzUiIHk9IjEwNy44MDEiIHdpZHRoPSIxOTAuNzExIiBoZWlnaHQ9IjIwMC4zNjciIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iaGFyZEFscGhhIi8+CjxmZU9mZnNldCBkeT0iMTkuMzEyNSIvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSI5LjY1NjI1Ii8+CjxmZUNvbXBvc2l0ZSBpbjI9ImhhcmRBbHBoYSIgb3BlcmF0b3I9Im91dCIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93XzEyXzIwNCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd18xMl8yMDQiIHJlc3VsdD0ic2hhcGUiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iaGFyZEFscGhhIi8+CjxmZU9mZnNldCBkeT0iLTkuNjU2MjUiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iOS42NTYyNSIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJhcml0aG1ldGljIiBrMj0iLTEiIGszPSIxIi8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAuNDU5NjIzIDAgMCAwIDAgMC43NzIyOTQgMCAwIDAgMCAwLjk5ODcxIDAgMCAwIDEgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0ic2hhcGUiIHJlc3VsdD0iZWZmZWN0Ml9pbm5lclNoYWRvd18xMl8yMDQiLz4KPC9maWx0ZXI+CjxyYWRpYWxHcmFkaWVudCBpZD0icGFpbnQwX3JhZGlhbF8xMl8yMDQiIGN4PSIwIiBjeT0iMCIgcj0iMSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGdyYWRpZW50VHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQ4LjM3NSAzMDQuNTQ3KSByb3RhdGUoNzQuNjExNSkgc2NhbGUoMjcyLjkxNykiPgo8c3RvcCBzdG9wLWNvbG9yPSIjQUVFN0ZGIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzE0NzJGRSIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo="
imgBtn.src = iconBase64;
imgBtn.setAttribute('id', 'imgBtn');
imgBtn.style.cssText += "position: fixed; top: 50%; transform: translateY(-50%); left: 0; width: 80px; height: 80px; z-index: 999";

// Listener for the floating button
imgBtn.addEventListener("click", receivedMessageDOM)
document.body.appendChild(imgBtn);

// Listener for background
chrome.runtime.onMessage.addListener(receivedMessageBG);

// Floating
function receivedMessageDOM (){
    // send msg to background?
    // trigger API call
    // modify DOM
    console.log("clicking floating button...")
}

// Top
function receivedMessageBG (message, sender, sendResponse) {
    // send msg to background?
    // trigger API call
    // modify DOM
    let title = document.querySelector('h1').textContent.trim();
    // window.location.href --> amazon or not --> id='title'
    console.log(title);
    console.log(message.txt);
};

